<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="https://nameless-taiga-88242.herokuapp.com/KOLuHYOrXW8T324wQ4OM.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sensor Status Information</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="/chart/dist/Chart.bundle.js"></script>
    <style>
        body {
            padding-top: 60px;
        }
    </style>

	<script>
		function refreshChart(){
			myChart.update(2000);
		}
	</script>
	<script>
		function defaultView(){
			var numdata = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];		
			
		}
	</script>
    <script>
		
        $(function() {
            $("#phoneChangerForm").submit(function(event) {
				event.preventDefault();
				
                $.ajax({
                    url: event.target.action,
                    method: event.target.method,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(data) {
						$("#sensorvalue").text(data.rows[0].sensorvalue__c);
						$("#sensortimestamp").text(data.rows[0].sensortimestamp__c);
						$("#id").text(data.rows[0].id);
						$("#name").text(data.rows[0].name);
						$("#deviceuser").text(data.rows[0].deviceuser__c);
						$("#deviceos").text(data.rows[0].deviceos__c);
						$("#loginuname").text(data.rows[0].loginuname__c);
						$("#devicename").text(data.rows[0].devicename__c);
						$("#_hc_lastop").text(data.rows[0]._hc_lastop);
						$("#mcuinfo").text(data.rows[0].mcuinfo__c);
						$("#deviceipint").text(data.rows[0].deviceipint__c);
						$("#deviceipext").text(data.rows[0].deviceipext__c);
						$("#localtime").text(data.rows[0].localtimestamppst__c);
						$("#sensorinfo").text(data.rows[0].sensorinfo__c);
						
						$("#a1").val(data.rows[0].sensorvalue__c);
						$("#a2").val(data.rows[1].sensorvalue__c);
						$("#a3").val(data.rows[2].sensorvalue__c);
						$("#a4").val(data.rows[3].sensorvalue__c);
						$("#a5").val(data.rows[4].sensorvalue__c);
						$("#a6").val(data.rows[5].sensorvalue__c);
						$("#a7").val(data.rows[6].sensorvalue__c);
						$("#a8").val(data.rows[7].sensorvalue__c);
						$("#a9").val(data.rows[8].sensorvalue__c);
						$("#a10").val(data.rows[9].sensorvalue__c);
						$("#a11").val(data.rows[10].sensorvalue__c);
						$("#a12").val(data.rows[11].sensorvalue__c);
						$("#a13").val(data.rows[12].sensorvalue__c);
						$("#a14").val(data.rows[13].sensorvalue__c);
						$("#a15").val(data.rows[14].sensorvalue__c);
						$("#a16").val(data.rows[15].sensorvalue__c);
						$("#a17").val(data.rows[16].sensorvalue__c);
						$("#a18").val(data.rows[17].sensorvalue__c);
						$("#a19").val(data.rows[18].sensorvalue__c);
						$("#a20").val(5);
						
						$("#b1").text(data.rows[0].localtime__c);
						$("#b2").text(data.rows[1].localtime__c);
						$("#b3").text(data.rows[2].localtime__c);
						$("#b4").text(data.rows[3].localtime__c);
						$("#b5").text(data.rows[4].localtime__c);
						$("#b6").text(data.rows[5].localtime__c);
						$("#b7").text(data.rows[6].localtime__c);
						$("#b8").text(data.rows[7].localtime__c);
						$("#b9").text(data.rows[8].localtime__c);
						$("#b10").text(data.rows[9].localtime__c);
						$("#b11").text(data.rows[10].localtime__c);
						$("#b12").text(data.rows[11].localtime__c);
						$("#b13").text(data.rows[12].localtime__c);
						$("#b14").text(data.rows[13].localtime__c);
						$("#b15").text(data.rows[14].localtime__c);
						$("#b16").text(data.rows[15].localtime__c);
						$("#b17").text(data.rows[16].localtime__c);
						$("#b18").text(data.rows[17].localtime__c);
						$("#b19").text(data.rows[18].localtime__c);
						$("#b20").text(data.rows[19].localtime__c);
					
						myChart.update(2000);
						
					}
                })
            });
        });
    </script>

</head>
<body onload = "defaultView()">
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="/"></a>
            </div>
        </div>
    </nav>
    <div class="container">
		<div class="panel panel-default">
			<div class="panel-heading">
                <h3 class="panel-title">Sensor Status Information</h3><br>
				<form id="phoneChangerForm" action="/update" method="get" style="width: 400px">
					<div>
						<button type="submit" class="btn btn-primary">Load Data</button>
					</div>
				</form><br>
				<div>
					<button type="submit" class="btn btn-primary" onclick="refreshChart()">Refresh Chart</button>
				</div>
            </div>
            <div class="panel-body" id="dataview">
                <div class="form-group" id="sv">
                    <label for="sensorvalue">Sensor Output:</label>
                    <div id="sensorvalue">
                </div><br>
				<div class="form-group" id="lt">
                    <label for="localtime">Local Timestamp (PST): </label>
                    <div id="localtime">
					
                </div><br>
                <div class="form-group" id="st">
                    <label for="sensortimestamp">Database Timestamp (GMT): </label>
                    <div id="sensortimestamp">
                </div><br>
				<div class="form-group" id="did">
                    <label for="id">Database Record ID Number: </label>
                    <div id="id">
                </div><br>
				<div class="form-group" id="dn">
                    <label for="name">Database Record Name:</label>
                    <div id="name">
                </div><br>
				<div class="form-group" id="du">
                    <label for="deviceuser">Device Username (Sensor PC): </label>
                    <div id="deviceuser">
                </div><br>
				<div class="form-group" id="ipi">
                    <label for="deviceipint">Device IP (External) (Sensor PC): </label>
                    <div id="deviceipint">
                </div><br>
				<div class="form-group" id="ipe">
                    <label for="deviceipext">Device IP (Internal) (Sensor PC): </label>
                    <div id="deviceipext">
                </div><br>
				<div class="form-group" id="os">
                    <label for="deviceos">Device Information (Sensor PC): </label>
                    <div id="deviceos">
                </div><br>
				<div class="form-group" id="syn">
                    <label for="_hc_lastop">Database Sync Status (Salesforce/Heroku): </label>
                    <div id="_hc_lastop">
                </div>
            	<div class="form-group" id="gv">
					<canvas id="myChart" width="400" height="400"></canvas>
					<script>
						var ctx = document.getElementById("myChart").getContext("2d");
						var myChart = new Chart(ctx , {
							type: 'line',
							data:{ 
								labels: [JSON.parse($("#b1")),$("#b2"),$("#b3"),$("#b4"),$("#b5"),
											$("#b6"),$("#b7"),$("#b8"),$("#b9"),$("#b10"),
											$("#b11"),$("#b12"),$("#b13"),$("#b14"),$("#b15"),
											$("#b16"),$("#b17"),$("#b18"),$("#b19"),$("#b20")],
								datasets:[{
									label: '# of Votes',
									data:  [JSON.parse($("#a1")),$("#a2"),$("#a3"),$("#a4"),$("#a5"),
											$("#a6"),$("#a7"),$("#a8"),$("#a9"),$("#a10"),
											$("#a11"),$("#a12"),$("#a13"),$("#a14"),$("#a15"),
											$("#a16"),$("#a17"),$("#a18"),$("#a19"),$("#a20")]
								}]
							}
						});
					</script>
				</div>
			</div>	
        </div>
    </div>
</body>
</html>